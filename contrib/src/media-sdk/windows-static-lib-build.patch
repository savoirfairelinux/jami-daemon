From 3a7f0691f18987ceaeacc21e26dc5b08b0a13c0f Mon Sep 17 00:00:00 2001
From: Eden Abitbol <eden.abitbol@savoirfairelinux.com>
Date: Tue, 23 Jul 2019 11:30:49 -0400
Subject: [PATCH] Copy build output to correct directory

---
 api/mfx_dispatch/windows/libmfx_vs2015.vcxproj | 17 +++++++++++++++--
 1 file changed, 15 insertions(+), 2 deletions(-)

--- a/api/mfx_dispatch/windows/libmfx_vs2015.vcxproj
+++ b/api/mfx_dispatch/windows/libmfx_vs2015.vcxproj
@@ -79,7 +79,7 @@
   </PropertyGroup>
   <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
   <PropertyGroup>
-    <OutDir>..\..\..\..\build\win_$(Platform)\$(Configuration)\lib\</OutDir>
+    <OutDir>..\..\..\build\win_$(Platform)\$(Configuration)\lib\</OutDir>
     <IntDir>$(OutDir)..\objs\$(ProjectName)\</IntDir>
     <IncludePath>$(MINIDDK_ROOT)\Include\um;$(MINIDDK_ROOT)\Include\shared;$(IncludePath)</IncludePath>
     <LibraryPath>$(MINIDDK_ROOT)\Lib\win8\um\x86;$(LibraryPath)</LibraryPath>
@@ -88,7 +88,7 @@
     <TargetName>$(ProjectName)</TargetName>
   </PropertyGroup>
   <PropertyGroup Condition="'$(Configuration)'=='Release'">
-    <TargetName>$(ProjectName)</TargetName>
+    <TargetName>libmfx</TargetName>
   </PropertyGroup>
   <ItemDefinitionGroup>
     <ClCompile>
@@ -208,6 +208,19 @@
       <ControlFlowGuard>Guard</ControlFlowGuard>
     </ClCompile>
     <Lib />
+    <Lib>
+      <OutputFile>$(OutDir)$(TargetName)$(TargetExt)</OutputFile>
+    </Lib>
+    <PostBuildEvent>
+      <Command>mkdir "$(OutDir)"..\..\..\..\..\..\msvc\include; mkdir "$(OutDir)"..\..\..\..\..\..\msvc\include\mfx; mkdir "$(OutDir)"..\..\..\..\..\..\msvc\lib; mkdir "$(OutDir)"..\..\..\..\..\..\msvc\lib\x64; 
+xcopy /S /Y "$(OutDir)"*.lib "$(OutDir)"..\..\..\..\..\..\msvc\lib\x64
+
+; 
+xcopy /S /Y "$(OutDir)"*.pdb "$(OutDir)"..\..\..\..\..\..\msvc\lib\x64
+; 
+xcopy /S /Y $(ProjectDir)include\*.h "$(OutDir)"..\..\..\..\..\..\msvc\include\mfx
+</Command>
+    </PostBuildEvent>
   </ItemDefinitionGroup>
   <ItemGroup>
     <ClCompile Include="src\main.cpp" />
-- 
2.22.0.windows.1

